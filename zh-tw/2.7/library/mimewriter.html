
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_TW">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>18.8. MimeWriter — Generic MIME file writer &#8212; Python 2.7.18 說明文件</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    
    <link rel="canonical" href="https://projects.localizethedocs.org/python-docs-l10n/library/mimewriter.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 2.7.18 說明文件 中搜尋"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="關於這些文件" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="copyright" title="版權所有" href="../copyright.html" />
    <link rel="next" title="18.9. mimify — MIME processing of mail messages" href="mimify.html" />
    <link rel="prev" title="18.7. mimetypes — Map filenames to MIME types" href="mimetypes.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/library/mimewriter.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">
            <script type="text/javascript" src="../ltd-provenance.js"></script>
            <script type="text/javascript" src="../ltd-current.js"></script>
            <script type="text/javascript" src="../../../ltd-config.js"></script>
            <script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <label for="menuToggler" class="toggler__label">
        <span></span>
    </label>
    <nav class="nav-content" role="navigation">
         <a href="https://www.python.org/" class="nav-logo">
             <img src="../_static/py.svg" alt="Logo"/>
         </a>
        <div class="version_switcher_placeholder"></div>
        <form id="searchbox" role="search" class="search" action="../search.html" method="get">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                <path fill-rule="nonzero"
                        d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#444"></path>
            </svg>
            <input type="text" name="q" aria-label="快速搜尋"/>
            <input type="submit" value="搜"/>
        </form>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
  <h3><a href="../contents.html">目录</a></h3>
  <ul>
<li><a class="reference internal" href="#">18.8. <code class="xref py py-mod docutils literal notranslate"><span class="pre">MimeWriter</span></code> — Generic MIME file writer</a><ul>
<li><a class="reference internal" href="#mimewriter-objects">18.8.1. MimeWriter Objects</a></li>
</ul>
</li>
</ul>

  <h4>上個主題</h4>
  <p class="topless"><a href="mimetypes.html"
                        title="上一章"><span class="section-number">18.7. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code> — Map filenames to MIME types</a></p>
  <h4>下個主題</h4>
  <p class="topless"><a href="mimify.html"
                        title="下一章"><span class="section-number">18.9. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimify</span></code> — MIME processing of mail messages</a></p>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/mimewriter.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="搜" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </nav>
    </div>
</div>

<div id="outdated-warning" style="padding: .5em; text-align: center; background-color: #FFBABA; color: #6A0E0E;">
    This document is for an old version of Python that is no longer supported.
    You should upgrade, and read the
    <a href="/3/library/mimewriter.html">Python documentation for the current stable release</a>.
</div>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="mimify.html" title="18.9. mimify — MIME processing of mail messages"
             accesskey="N">下一頁</a> |</li>
        <li class="right" >
          <a href="mimetypes.html" title="18.7. mimetypes — Map filenames to MIME types"
             accesskey="P">上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
          <li id="cpython-language-and-version">
            <a href="../index.html">Python 2.7.18 說明文件</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Python Standard Library</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="netdata.html" accesskey="U"><span class="section-number">18. </span>Internet Data Handling</a> &#187;</li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="text" name="q" />
          <input type="submit" value="搜" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-MimeWriter">
<span id="mimewriter-generic-mime-file-writer"></span><h1><span class="section-number">18.8. </span><a class="reference internal" href="#module-MimeWriter" title="MimeWriter: Write MIME format files.(已棄用)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MimeWriter</span></code></a> — Generic MIME file writer<a class="headerlink" href="#module-MimeWriter" title="本標題的永久連結">¶</a></h1>
<div class="deprecated">
<p><span class="versionmodified deprecated">2.3 版後已棄用: </span>The <a class="reference internal" href="email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages, including MIME documents."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code></a> package should be used in preference to the <a class="reference internal" href="#module-MimeWriter" title="MimeWriter: Write MIME format files.(已棄用)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MimeWriter</span></code></a>
module.  This module is present only to maintain backward compatibility.</p>
</div>
<p>This module defines the class <a class="reference internal" href="#MimeWriter.MimeWriter" title="MimeWriter.MimeWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MimeWriter</span></code></a>.  The <a class="reference internal" href="#MimeWriter.MimeWriter" title="MimeWriter.MimeWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MimeWriter</span></code></a>
class implements a basic formatter for creating MIME multi-part files.  It
doesn’t seek around the output file nor does it use large amounts of buffer
space. You must write the parts out in the order that they should occur in the
final file. <a class="reference internal" href="#MimeWriter.MimeWriter" title="MimeWriter.MimeWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MimeWriter</span></code></a> does buffer the headers you add, allowing you
to rearrange their order.</p>
<dl class="class">
<dt id="MimeWriter.MimeWriter">
<em class="property">class </em><code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">MimeWriter</code><span class="sig-paren">(</span><em class="sig-param">fp</em><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter" title="本定義的永久連結">¶</a></dt>
<dd><p>Return a new instance of the <a class="reference internal" href="#MimeWriter.MimeWriter" title="MimeWriter.MimeWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MimeWriter</span></code></a> class.  The only argument
passed, <em>fp</em>, is a file object to be used for writing. Note that a
<a class="reference internal" href="stringio.html#StringIO.StringIO" title="StringIO.StringIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">StringIO</span></code></a> object could also be used.</p>
</dd></dl>

<section id="mimewriter-objects">
<span id="id1"></span><h2><span class="section-number">18.8.1. </span>MimeWriter Objects<a class="headerlink" href="#mimewriter-objects" title="本標題的永久連結">¶</a></h2>
<p><a class="reference internal" href="#MimeWriter.MimeWriter" title="MimeWriter.MimeWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MimeWriter</span></code></a> instances have the following methods:</p>
<dl class="method">
<dt id="MimeWriter.MimeWriter.addheader">
<code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">addheader</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value</em><span class="optional">[</span>, <em class="sig-param">prefix</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter.addheader" title="本定義的永久連結">¶</a></dt>
<dd><p>Add a header line to the MIME message. The <em>key</em> is the name of the header,
where the <em>value</em> obviously provides the value of the header. The optional
argument <em>prefix</em> determines where the header  is inserted; <code class="docutils literal notranslate"><span class="pre">0</span></code> means append
at the end, <code class="docutils literal notranslate"><span class="pre">1</span></code> is insert at the start. The default is to append.</p>
</dd></dl>

<dl class="method">
<dt id="MimeWriter.MimeWriter.flushheaders">
<code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">flushheaders</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter.flushheaders" title="本定義的永久連結">¶</a></dt>
<dd><p>Causes all headers accumulated so far to be written out (and forgotten). This is
useful if you don’t need a body part at all, e.g. for a subpart of type
<em class="mimetype">message/rfc822</em> that’s (mis)used to store some header-like
information.</p>
</dd></dl>

<dl class="method">
<dt id="MimeWriter.MimeWriter.startbody">
<code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">startbody</code><span class="sig-paren">(</span><em class="sig-param">ctype</em><span class="optional">[</span>, <em class="sig-param">plist</em><span class="optional">[</span>, <em class="sig-param">prefix</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter.startbody" title="本定義的永久連結">¶</a></dt>
<dd><p>Returns a file-like object which can be used to write to the body of the
message.  The content-type is set to the provided <em>ctype</em>, and the optional
parameter <em>plist</em> provides additional parameters for the content-type
declaration. <em>prefix</em> functions as in <a class="reference internal" href="#MimeWriter.MimeWriter.addheader" title="MimeWriter.MimeWriter.addheader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addheader()</span></code></a> except that the default
is to insert at the start.</p>
</dd></dl>

<dl class="method">
<dt id="MimeWriter.MimeWriter.startmultipartbody">
<code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">startmultipartbody</code><span class="sig-paren">(</span><em class="sig-param">subtype</em><span class="optional">[</span>, <em class="sig-param">boundary</em><span class="optional">[</span>, <em class="sig-param">plist</em><span class="optional">[</span>, <em class="sig-param">prefix</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter.startmultipartbody" title="本定義的永久連結">¶</a></dt>
<dd><p>Returns a file-like object which can be used to write to the body of the
message.  Additionally, this method initializes the multi-part code, where
<em>subtype</em> provides the multipart subtype, <em>boundary</em> may provide a user-defined
boundary specification, and <em>plist</em> provides optional parameters for the
subtype. <em>prefix</em> functions as in <a class="reference internal" href="#MimeWriter.MimeWriter.startbody" title="MimeWriter.MimeWriter.startbody"><code class="xref py py-meth docutils literal notranslate"><span class="pre">startbody()</span></code></a>.  Subparts should be created
using <a class="reference internal" href="#MimeWriter.MimeWriter.nextpart" title="MimeWriter.MimeWriter.nextpart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nextpart()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MimeWriter.MimeWriter.nextpart">
<code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">nextpart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter.nextpart" title="本定義的永久連結">¶</a></dt>
<dd><p>Returns a new instance of <a class="reference internal" href="#MimeWriter.MimeWriter" title="MimeWriter.MimeWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">MimeWriter</span></code></a> which represents an individual
part in a multipart message.  This may be used to write the  part as well as
used for creating recursively complex multipart messages. The message must first
be initialized with <a class="reference internal" href="#MimeWriter.MimeWriter.startmultipartbody" title="MimeWriter.MimeWriter.startmultipartbody"><code class="xref py py-meth docutils literal notranslate"><span class="pre">startmultipartbody()</span></code></a> before using <a class="reference internal" href="#MimeWriter.MimeWriter.nextpart" title="MimeWriter.MimeWriter.nextpart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nextpart()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MimeWriter.MimeWriter.lastpart">
<code class="sig-prename descclassname">MimeWriter.</code><code class="sig-name descname">lastpart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MimeWriter.MimeWriter.lastpart" title="本定義的永久連結">¶</a></dt>
<dd><p>This is used to designate the last part of a multipart message, and should
<em>always</em> be used when writing multipart messages.</p>
</dd></dl>

</section>
</section>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目录</a></h3>
  <ul>
<li><a class="reference internal" href="#">18.8. <code class="xref py py-mod docutils literal notranslate"><span class="pre">MimeWriter</span></code> — Generic MIME file writer</a><ul>
<li><a class="reference internal" href="#mimewriter-objects">18.8.1. MimeWriter Objects</a></li>
</ul>
</li>
</ul>

  <h4>上個主題</h4>
  <p class="topless"><a href="mimetypes.html"
                        title="上一章"><span class="section-number">18.7. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code> — Map filenames to MIME types</a></p>
  <h4>下個主題</h4>
  <p class="topless"><a href="mimify.html"
                        title="下一章"><span class="section-number">18.9. </span><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimify</span></code> — MIME processing of mail messages</a></p>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/mimewriter.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="搜" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>瀏覽</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="總索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模組索引"
             >模組</a> |</li>
        <li class="right" >
          <a href="mimify.html" title="18.9. mimify — MIME processing of mail messages"
             >下一頁</a> |</li>
        <li class="right" >
          <a href="mimetypes.html" title="18.7. mimetypes — Map filenames to MIME types"
             >上一頁</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
          <li id="cpython-language-and-version">
            <a href="../index.html">Python 2.7.18 說明文件</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Python Standard Library</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="netdata.html" ><span class="section-number">18. </span>Internet Data Handling</a> &#187;</li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜尋" aria-label="快速搜尋" type="text" name="q" />
          <input type="submit" value="搜" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">版權所有</a> 1990-2025, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="">History and License</a> for more information.
    <br /><br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    最後更新於 10月 28, 2025。
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>

  </body>
</html>