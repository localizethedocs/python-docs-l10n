
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The Python Profilers &#8212; Python 3.0.1 文档</title>
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    
    <link rel="canonical" href="https://projects.localizethedocs.org/python-docs-l10n/library/profile.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.0.1 文档 中搜索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="关于这些文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权所有" href="../copyright.html" />
    <link rel="next" title="timeit — Measure execution time of small code snippets" href="timeit.html" />
    <link rel="prev" title="pdb — The Python Debugger" href="pdb.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/library/profile.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>

    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
     

            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">
            <script type="text/javascript" src="../ltd-provenance.js"></script>
            <script type="text/javascript" src="../ltd-current.js"></script>
            <script type="text/javascript" src="../../../ltd-config.js"></script>
            <script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head><body>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="timeit.html" title="timeit — Measure execution time of small code snippets"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="pdb.html" title="pdb — The Python Debugger"
             accesskey="P">上一页</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

          <li id="cpython-language-and-version">
            <a href="../index.html">Python 3.0.1 文档</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Python Standard Library</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="debug.html" accesskey="U">Debugging and Profiling</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" type="text" name="q" />
          <input type="submit" value="转向" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-python-profilers">
<span id="profile"></span><h1>The Python Profilers<a class="headerlink" href="#the-python-profilers" title="永久链接至标题">¶</a></h1>
<p id="index-0">Copyright © 1994, by InfoSeek Corporation, all rights reserved.</p>
<p>Written by James Roskind. <a class="footnote-reference" href="#id2" id="id1">[1]</a></p>
<p>Permission to use, copy, modify, and distribute this Python software and its
associated documentation for any purpose (subject to the restriction in the
following sentence) without fee is hereby granted, provided that the above
copyright notice appears in all copies, and that both that copyright notice and
this permission notice appear in supporting documentation, and that the name of
InfoSeek not be used in advertising or publicity pertaining to distribution of
the software without specific, written prior permission.  This permission is
explicitly restricted to the copying and modification of the software to remain
in Python, compiled Python, or other languages (such as C) wherein the modified
or derived code is exclusively imported into a Python module.</p>
<p>INFOSEEK CORPORATION DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,
INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT
SHALL INFOSEEK CORPORATION BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</p>
<div class="section" id="introduction-to-the-profilers">
<span id="profiler-introduction"></span><h2>Introduction to the profilers<a class="headerlink" href="#introduction-to-the-profilers" title="永久链接至标题">¶</a></h2>
<p id="index-1">A <em class="dfn">profiler</em> is a program that describes the run time performance
of a program, providing a variety of statistics.  This documentation
describes the profiler functionality provided in the modules
<a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> and <a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a>.  This profiler
provides <em class="dfn">deterministic profiling</em> of Python programs.  It also
provides a series of report generation tools to allow users to rapidly
examine the results of a profile operation.</p>
<p>The Python standard library provides two different profilers:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> is recommended for most users; it’s a C extension
with reasonable overhead
that makes it suitable for profiling long-running programs.
Based on <code class="xref py py-mod docutils literal notranslate"><span class="pre">lsprof</span></code>,
contributed by Brett Rosen and Ted Czotter.</li>
<li><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code>, a pure Python module whose interface is imitated by
<a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>.  Adds significant overhead to profiled programs.
If you’re trying to extend
the profiler in some way, the task might be easier with this module.
Copyright © 1994, by InfoSeek Corporation.</li>
</ol>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> and <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> modules export the same interface, so
they are mostly interchangeable; <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> has a much lower overhead but
is newer and might not be available on all systems.
<a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> is really a compatibility layer on top of the internal
<code class="xref py py-mod docutils literal notranslate"><span class="pre">_lsprof</span></code> module.</p>
</div>
<div class="section" id="instant-user-s-manual">
<span id="profile-instant"></span><h2>Instant User’s Manual<a class="headerlink" href="#instant-user-s-manual" title="永久链接至标题">¶</a></h2>
<p>This section is provided for users that “don’t want to read the manual.” It
provides a very brief overview, and allows a user to rapidly perform profiling
on an existing application.</p>
<p>To profile an application with a main entry point of <code class="xref py py-func docutils literal notranslate"><span class="pre">foo()</span></code>, you would add
the following to your module:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span>
<span class="n">cProfile</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;foo()&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(Use <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> instead of <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> if the latter is not available on
your system.)</p>
<p>The above action would cause <code class="xref py py-func docutils literal notranslate"><span class="pre">foo()</span></code> to be run, and a series of informative
lines (the profile) to be printed.  The above approach is most useful when
working with the interpreter.  If you would like to save the results of a
profile into a file for later examination, you can supply a file name as the
second argument to the <code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code> function:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span>
<span class="n">cProfile</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;foo()&#39;</span><span class="p">,</span> <span class="s1">&#39;fooprof&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The file <code class="file docutils literal notranslate"><span class="pre">cProfile.py</span></code> can also be invoked as a script to profile another
script.  For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">cProfile</span> <span class="n">myscript</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><code class="file docutils literal notranslate"><span class="pre">cProfile.py</span></code> accepts two optional arguments on the command line:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cProfile</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">output_file</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">sort_order</span><span class="p">]</span>
</pre></div>
</div>
<p><a class="reference internal" href="../using/cmdline.html#cmdoption-s"><code class="xref std std-option docutils literal notranslate"><span class="pre">-s</span></code></a> only applies to standard output (<code class="xref std std-option docutils literal notranslate"><span class="pre">-o</span></code> is not supplied).
Look in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code> documentation for valid sort values.</p>
<p>When you wish to review the profile, you should use the methods in the
<a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a> module.  Typically you would load the statistics data as follows:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pstats</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="s1">&#39;fooprof&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The class <code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code> (the above code just created an instance of this class)
has a variety of methods for manipulating and printing the data that was just
read into <code class="docutils literal notranslate"><span class="pre">p</span></code>.  When you ran <a class="reference internal" href="#cProfile.run" title="cProfile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">cProfile.run()</span></code></a> above, what was printed was
the result of three method calls:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</pre></div>
</div>
<p>The first method removed the extraneous path from all the module names. The
second method sorted all the entries according to the standard module/line/name
string that is printed. The third method printed out all the statistics.  You
might try the following sort calls:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</pre></div>
</div>
<p>The first call will actually sort the list by function name, and the second call
will print out the statistics.  The following are some interesting calls to
experiment with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;cumulative&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This sorts the profile by cumulative time in a function, and then only prints
the ten most significant lines.  If you want to understand what algorithms are
taking time, the above line is what you would use.</p>
<p>If you were looking to see what functions were looping a lot, and taking a lot
of time, you would do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>to sort according to time spent within each function, and then print the
statistics for the top ten functions.</p>
<p>You might also try:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="s1">&#39;__init__&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will sort all the statistics by file name, and then print out statistics
for only the class init methods (since they are spelled with <code class="docutils literal notranslate"><span class="pre">__init__</span></code> in
them).  As one final example, you could try:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;cum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This line sorts statistics with a primary key of time, and a secondary key of
cumulative time, and then prints out some of the statistics. To be specific, the
list is first culled down to 50% (re: <code class="docutils literal notranslate"><span class="pre">.5</span></code>) of its original size, then only
lines containing <code class="docutils literal notranslate"><span class="pre">init</span></code> are maintained, and that sub-sub-list is printed.</p>
<p>If you wondered what functions called the above functions, you could now (<code class="docutils literal notranslate"><span class="pre">p</span></code>
is still sorted according to the last criteria) do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">print_callers</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and you would get a list of callers for each of the listed functions.</p>
<p>If you want more functionality, you’re going to have to read the manual, or
guess what the following functions do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">print_callees</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;fooprof&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Invoked as a script, the <a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a> module is a statistics browser for
reading and examining profile dumps.  It has a simple line-oriented interface
(implemented using <a class="reference internal" href="cmd.html#module-cmd" title="cmd: Build line-oriented command interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">cmd</span></code></a>) and interactive help.</p>
</div>
<div class="section" id="what-is-deterministic-profiling">
<span id="deterministic-profiling"></span><h2>What Is Deterministic Profiling?<a class="headerlink" href="#what-is-deterministic-profiling" title="永久链接至标题">¶</a></h2>
<p><em class="dfn">Deterministic profiling</em> is meant to reflect the fact that all <em>function
call</em>, <em>function return</em>, and <em>exception</em> events are monitored, and precise
timings are made for the intervals between these events (during which time the
user’s code is executing).  In contrast, <em class="dfn">statistical profiling</em> (which is
not done by this module) randomly samples the effective instruction pointer, and
deduces where time is being spent.  The latter technique traditionally involves
less overhead (as the code does not need to be instrumented), but provides only
relative indications of where time is being spent.</p>
<p>In Python, since there is an interpreter active during execution, the presence
of instrumented code is not required to do deterministic profiling.  Python
automatically provides a <em class="dfn">hook</em> (optional callback) for each event.  In
addition, the interpreted nature of Python tends to add so much overhead to
execution, that deterministic profiling tends to only add small processing
overhead in typical applications.  The result is that deterministic profiling is
not that expensive, yet provides extensive run time statistics about the
execution of a Python program.</p>
<p>Call count statistics can be used to identify bugs in code (surprising counts),
and to identify possible inline-expansion points (high call counts).  Internal
time statistics can be used to identify “hot loops” that should be carefully
optimized.  Cumulative time statistics should be used to identify high level
errors in the selection of algorithms.  Note that the unusual handling of
cumulative times in this profiler allows statistics for recursive
implementations of algorithms to be directly compared to iterative
implementations.</p>
</div>
<div class="section" id="module-cProfile">
<span id="reference-manual-profile-and-cprofile"></span><h2>Reference Manual – <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> and <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a><a class="headerlink" href="#module-cProfile" title="永久链接至标题">¶</a></h2>
<p>The primary entry point for the profiler is the global function
<code class="xref py py-func docutils literal notranslate"><span class="pre">profile.run()</span></code> (resp. <a class="reference internal" href="#cProfile.run" title="cProfile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">cProfile.run()</span></code></a>). It is typically used to create
any profile information.  The reports are formatted and printed using methods of
the class <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstats.Stats</span></code></a>.  The following is a description of all of these
standard entry points and functions.  For a more in-depth view of some of the
code, consider reading the later section on Profiler Extensions, which includes
discussion of how to derive “better” profilers from the classes presented, or
reading the source code for these modules.</p>
<dl class="function">
<dt id="cProfile.run">
<code class="descclassname">cProfile.</code><code class="descname">run</code><span class="sig-paren">(</span><em>command</em><span class="optional">[</span>, <em>filename</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#cProfile.run" title="永久链接至目标">¶</a></dt>
<dd><p>This function takes a single argument that can be passed to the <a class="reference internal" href="functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>
function, and an optional file name.  In all cases this routine attempts to
<a class="reference internal" href="functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a> its first argument, and gather profiling statistics from the
execution. If no file name is present, then this function automatically
prints a simple profiling report, sorted by the standard name string
(file/line/function-name) that is presented in each line.  The following is a
typical output from such a call:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>      <span class="mi">2706</span> <span class="n">function</span> <span class="n">calls</span> <span class="p">(</span><span class="mi">2004</span> <span class="n">primitive</span> <span class="n">calls</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">4.504</span> <span class="n">CPU</span> <span class="n">seconds</span>

<span class="n">Ordered</span> <span class="n">by</span><span class="p">:</span> <span class="n">standard</span> <span class="n">name</span>

<span class="n">ncalls</span>  <span class="n">tottime</span>  <span class="n">percall</span>  <span class="n">cumtime</span>  <span class="n">percall</span> <span class="n">filename</span><span class="p">:</span><span class="n">lineno</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
     <span class="mi">2</span>    <span class="mf">0.006</span>    <span class="mf">0.003</span>    <span class="mf">0.953</span>    <span class="mf">0.477</span> <span class="n">pobject</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">75</span><span class="p">(</span><span class="n">save_objects</span><span class="p">)</span>
  <span class="mi">43</span><span class="o">/</span><span class="mi">3</span>    <span class="mf">0.533</span>    <span class="mf">0.012</span>    <span class="mf">0.749</span>    <span class="mf">0.250</span> <span class="n">pobject</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">99</span><span class="p">(</span><span class="n">evaluate</span><span class="p">)</span>
 <span class="o">...</span>
</pre></div>
</div>
<p>The first line indicates that 2706 calls were monitored.  Of those calls, 2004
were <em class="dfn">primitive</em>.  We define <em class="dfn">primitive</em> to mean that the call was not
induced via recursion. The next line: <code class="docutils literal notranslate"><span class="pre">Ordered</span> <span class="pre">by:</span> <span class="pre">standard</span> <span class="pre">name</span></code>, indicates
that the text string in the far right column was used to sort the output. The
column headings include:</p>
<dl class="docutils">
<dt>ncalls</dt>
<dd>for the number of calls,</dd>
<dt>tottime</dt>
<dd>for the total time spent in the given function (and excluding time made in calls
to sub-functions),</dd>
<dt>percall</dt>
<dd>is the quotient of <code class="docutils literal notranslate"><span class="pre">tottime</span></code> divided by <code class="docutils literal notranslate"><span class="pre">ncalls</span></code></dd>
<dt>cumtime</dt>
<dd>is the total time spent in this and all subfunctions (from invocation till
exit). This figure is accurate <em>even</em> for recursive functions.</dd>
<dt>percall</dt>
<dd>is the quotient of <code class="docutils literal notranslate"><span class="pre">cumtime</span></code> divided by primitive calls</dd>
<dt>filename:lineno(function)</dt>
<dd>provides the respective data of each function</dd>
</dl>
<p>When there are two numbers in the first column (for example, <code class="docutils literal notranslate"><span class="pre">43/3</span></code>), then the
latter is the number of primitive calls, and the former is the actual number of
calls.  Note that when the function does not recurse, these two values are the
same, and only the single figure is printed.</p>
</dd></dl>

<dl class="function">
<dt id="cProfile.runctx">
<code class="descclassname">cProfile.</code><code class="descname">runctx</code><span class="sig-paren">(</span><em>command</em>, <em>globals</em>, <em>locals</em><span class="optional">[</span>, <em>filename</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#cProfile.runctx" title="永久链接至目标">¶</a></dt>
<dd><p>This function is similar to <a class="reference internal" href="#cProfile.run" title="cProfile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a>, with added arguments to supply the
globals and locals dictionaries for the <em>command</em> string.</p>
</dd></dl>

<p>Analysis of the profiler data is done using the <code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code> class.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">The <code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code> class is defined in the <a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a> module.</p>
</div>
<span class="target" id="module-pstats"></span><dl class="class">
<dt id="pstats.Stats">
<em class="property">class </em><code class="descclassname">pstats.</code><code class="descname">Stats</code><span class="sig-paren">(</span><em>filename</em><span class="optional">[</span>, <em>stream=sys.stdout</em><span class="optional">[</span>, <em>...</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats" title="永久链接至目标">¶</a></dt>
<dd><p>This class constructor creates an instance of a “statistics object” from a
<em>filename</em> (or set of filenames).  <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> objects are manipulated by
methods, in order to print useful reports.  You may specify an alternate output
stream by giving the keyword argument, <code class="docutils literal notranslate"><span class="pre">stream</span></code>.</p>
<p>The file selected by the above constructor must have been created by the
corresponding version of <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> or <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>.  To be specific,
there is <em>no</em> file compatibility guaranteed with future versions of this
profiler, and there is no compatibility with files produced by other profilers.
If several files are provided, all the statistics for identical functions will
be coalesced, so that an overall view of several processes can be considered in
a single report.  If additional files need to be combined with data in an
existing <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object, the <a class="reference internal" href="#pstats.Stats.add" title="pstats.Stats.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> method can be used.</p>
</dd></dl>

<div class="section" id="the-stats-class">
<span id="profile-stats"></span><h3>The <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> Class<a class="headerlink" href="#the-stats-class" title="永久链接至标题">¶</a></h3>
<p><a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> objects have the following methods:</p>
<dl class="method">
<dt id="pstats.Stats.strip_dirs">
<code class="descclassname">Stats.</code><code class="descname">strip_dirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.strip_dirs" title="永久链接至目标">¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class removes all leading path information
from file names.  It is very useful in reducing the size of the printout to fit
within (close to) 80 columns.  This method modifies the object, and the stripped
information is lost.  After performing a strip operation, the object is
considered to have its entries in a “random” order, as it was just after object
initialization and loading.  If <a class="reference internal" href="#pstats.Stats.strip_dirs" title="pstats.Stats.strip_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strip_dirs()</span></code></a> causes two function names to
be indistinguishable (they are on the same line of the same filename, and have
the same function name), then the statistics for these two entries are
accumulated into a single entry.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.add">
<code class="descclassname">Stats.</code><code class="descname">add</code><span class="sig-paren">(</span><em>filename</em><span class="optional">[</span>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.add" title="永久链接至目标">¶</a></dt>
<dd><p>This method of the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class accumulates additional profiling
information into the current profiling object.  Its arguments should refer to
filenames created by the corresponding version of <code class="xref py py-func docutils literal notranslate"><span class="pre">profile.run()</span></code> or
<a class="reference internal" href="#cProfile.run" title="cProfile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">cProfile.run()</span></code></a>. Statistics for identically named (re: file, line, name)
functions are automatically accumulated into single function statistics.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.dump_stats">
<code class="descclassname">Stats.</code><code class="descname">dump_stats</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.dump_stats" title="永久链接至目标">¶</a></dt>
<dd><p>Save the data loaded into the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object to a file named <em>filename</em>.
The file is created if it does not exist, and is overwritten if it already
exists.  This is equivalent to the method of the same name on the
<code class="xref py py-class docutils literal notranslate"><span class="pre">profile.Profile</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code> classes.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.sort_stats">
<code class="descclassname">Stats.</code><code class="descname">sort_stats</code><span class="sig-paren">(</span><em>key</em><span class="optional">[</span>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.sort_stats" title="永久链接至目标">¶</a></dt>
<dd><p>This method modifies the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object by sorting it according to the
supplied criteria.  The argument is typically a string identifying the basis of
a sort (example: <code class="docutils literal notranslate"><span class="pre">'time'</span></code> or <code class="docutils literal notranslate"><span class="pre">'name'</span></code>).</p>
<p>When more than one key is provided, then additional keys are used as secondary
criteria when there is equality in all keys selected before them.  For example,
<code class="docutils literal notranslate"><span class="pre">sort_stats('name',</span> <span class="pre">'file')</span></code> will sort all the entries according to their
function name, and resolve all ties (identical function names) by sorting by
file name.</p>
<p>Abbreviations can be used for any key names, as long as the abbreviation is
unambiguous.  The following are the keys currently defined:</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Valid Arg</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'calls'</span></code></td>
<td>call count</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'cumulative'</span></code></td>
<td>cumulative time</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'file'</span></code></td>
<td>file name</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'module'</span></code></td>
<td>file name</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'pcalls'</span></code></td>
<td>primitive call count</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'line'</span></code></td>
<td>line number</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'name'</span></code></td>
<td>function name</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'nfl'</span></code></td>
<td>name/file/line</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">'stdname'</span></code></td>
<td>standard name</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">'time'</span></code></td>
<td>internal time</td>
</tr>
</tbody>
</table>
<p>Note that all sorts on statistics are in descending order (placing most time
consuming items first), where as name, file, and line number searches are in
ascending order (alphabetical). The subtle distinction between <code class="docutils literal notranslate"><span class="pre">'nfl'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'stdname'</span></code> is that the standard name is a sort of the name as printed, which
means that the embedded line numbers get compared in an odd way.  For example,
lines 3, 20, and 40 would (if the file names were the same) appear in the string
order 20, 3 and 40.  In contrast, <code class="docutils literal notranslate"><span class="pre">'nfl'</span></code> does a numeric compare of the line
numbers.  In fact, <code class="docutils literal notranslate"><span class="pre">sort_stats('nfl')</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">sort_stats('name',</span>
<span class="pre">'file',</span> <span class="pre">'line')</span></code>.</p>
<p>For backward-compatibility reasons, the numeric arguments <code class="docutils literal notranslate"><span class="pre">-1</span></code>, <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>,
and <code class="docutils literal notranslate"><span class="pre">2</span></code> are permitted.  They are interpreted as <code class="docutils literal notranslate"><span class="pre">'stdname'</span></code>, <code class="docutils literal notranslate"><span class="pre">'calls'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'time'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'cumulative'</span></code> respectively.  If this old style format
(numeric) is used, only one sort key (the numeric key) will be used, and
additional arguments will be silently ignored.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.reverse_order">
<code class="descclassname">Stats.</code><code class="descname">reverse_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.reverse_order" title="永久链接至目标">¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class reverses the ordering of the basic list
within the object.  Note that by default ascending vs descending order is
properly selected based on the sort key of choice.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.print_stats">
<code class="descclassname">Stats.</code><code class="descname">print_stats</code><span class="sig-paren">(</span><span class="optional">[</span><em>restriction</em>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.print_stats" title="永久链接至目标">¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class prints out a report as described in the
<code class="xref py py-func docutils literal notranslate"><span class="pre">profile.run()</span></code> definition.</p>
<p>The order of the printing is based on the last <a class="reference internal" href="#pstats.Stats.sort_stats" title="pstats.Stats.sort_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_stats()</span></code></a> operation done
on the object (subject to caveats in <a class="reference internal" href="#pstats.Stats.add" title="pstats.Stats.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> and <a class="reference internal" href="#pstats.Stats.strip_dirs" title="pstats.Stats.strip_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strip_dirs()</span></code></a>).</p>
<p>The arguments provided (if any) can be used to limit the list down to the
significant entries.  Initially, the list is taken to be the complete set of
profiled functions.  Each restriction is either an integer (to select a count of
lines), or a decimal fraction between 0.0 and 1.0 inclusive (to select a
percentage of lines), or a regular expression (to pattern match the standard
name that is printed; as of Python 1.5b1, this uses the Perl-style regular
expression syntax defined by the <a class="reference internal" href="re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a> module).  If several restrictions are
provided, then they are applied sequentially.  For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_stats</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="s1">&#39;foo:&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>would first limit the printing to first 10% of list, and then only print
functions that were part of filename <code class="file docutils literal notranslate"><span class="pre">.*foo:</span></code>.  In contrast, the
command:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_stats</span><span class="p">(</span><span class="s1">&#39;foo:&#39;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)</span>
</pre></div>
</div>
<p>would limit the list to all functions having file names <code class="file docutils literal notranslate"><span class="pre">.*foo:</span></code>, and
then proceed to only print the first 10% of them.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.print_callers">
<code class="descclassname">Stats.</code><code class="descname">print_callers</code><span class="sig-paren">(</span><span class="optional">[</span><em>restriction</em>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.print_callers" title="永久链接至目标">¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class prints a list of all functions that
called each function in the profiled database.  The ordering is identical to
that provided by <a class="reference internal" href="#pstats.Stats.print_stats" title="pstats.Stats.print_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_stats()</span></code></a>, and the definition of the restricting
argument is also identical.  Each caller is reported on its own line.  The
format differs slightly depending on the profiler that produced the stats:</p>
<ul class="simple">
<li>With <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code>, a number is shown in parentheses after each caller to
show how many times this specific call was made.  For convenience, a second
non-parenthesized number repeats the cumulative time spent in the function
at the right.</li>
<li>With <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>, each caller is preceded by three numbers: the number of
times this specific call was made, and the total and cumulative times spent in
the current function while it was invoked by this specific caller.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.print_callees">
<code class="descclassname">Stats.</code><code class="descname">print_callees</code><span class="sig-paren">(</span><span class="optional">[</span><em>restriction</em>, <em>...</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.print_callees" title="永久链接至目标">¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class prints a list of all function that were
called by the indicated function.  Aside from this reversal of direction of
calls (re: called vs was called by), the arguments and ordering are identical to
the <a class="reference internal" href="#pstats.Stats.print_callers" title="pstats.Stats.print_callers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_callers()</span></code></a> method.</p>
</dd></dl>

</div>
</div>
<div class="section" id="limitations">
<span id="profile-limits"></span><h2>Limitations<a class="headerlink" href="#limitations" title="永久链接至标题">¶</a></h2>
<p>One limitation has to do with accuracy of timing information. There is a
fundamental problem with deterministic profilers involving accuracy.  The most
obvious restriction is that the underlying “clock” is only ticking at a rate
(typically) of about .001 seconds.  Hence no measurements will be more accurate
than the underlying clock.  If enough measurements are taken, then the “error”
will tend to average out. Unfortunately, removing this first error induces a
second source of error.</p>
<p>The second problem is that it “takes a while” from when an event is dispatched
until the profiler’s call to get the time actually <em>gets</em> the state of the
clock.  Similarly, there is a certain lag when exiting the profiler event
handler from the time that the clock’s value was obtained (and then squirreled
away), until the user’s code is once again executing.  As a result, functions
that are called many times, or call many functions, will typically accumulate
this error. The error that accumulates in this fashion is typically less than
the accuracy of the clock (less than one clock tick), but it <em>can</em> accumulate
and become very significant.</p>
<p>The problem is more important with <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> than with the lower-overhead
<a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>.  For this reason, <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> provides a means of
calibrating itself for a given platform so that this error can be
probabilistically (on the average) removed. After the profiler is calibrated, it
will be more accurate (in a least square sense), but it will sometimes produce
negative numbers (when call counts are exceptionally low, and the gods of
probability work against you :-). )  Do <em>not</em> be alarmed by negative numbers in
the profile.  They should <em>only</em> appear if you have calibrated your profiler,
and the results are actually better than without calibration.</p>
</div>
<div class="section" id="calibration">
<span id="profile-calibration"></span><h2>Calibration<a class="headerlink" href="#calibration" title="永久链接至标题">¶</a></h2>
<p>The profiler of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> module subtracts a constant from each event
handling time to compensate for the overhead of calling the time function, and
socking away the results.  By default, the constant is 0. The following
procedure can be used to obtain a better constant for a given platform (see
discussion in section Limitations above).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">profile</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
</pre></div>
</div>
<p>The method executes the number of Python calls given by the argument, directly
and again under the profiler, measuring the time for both. It then computes the
hidden overhead per profiler event, and returns that as a float.  For example,
on an 800 MHz Pentium running Windows 2000, and using Python’s time.clock() as
the timer, the magical number is about 12.5e-6.</p>
<p>The object of this exercise is to get a fairly consistent result. If your
computer is <em>very</em> fast, or your timer function has poor resolution, you might
have to pass 100000, or even 1000000, to get consistent results.</p>
<p>When you have a consistent answer, there are three ways you can use it:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">profile</span>

<span class="c1"># 1. Apply computed bias to all Profile instances created hereafter.</span>
<span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">your_computed_bias</span>

<span class="c1"># 2. Apply computed bias to a specific Profile instance.</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">your_computed_bias</span>

<span class="c1"># 3. Specify computed bias in instance constructor.</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="n">your_computed_bias</span><span class="p">)</span>
</pre></div>
</div>
<p>If you have a choice, you are better off choosing a smaller constant, and then
your results will “less often” show up as negative in profile statistics.</p>
</div>
<div class="section" id="extensions-deriving-better-profilers">
<span id="profiler-extensions"></span><h2>Extensions — Deriving Better Profilers<a class="headerlink" href="#extensions-deriving-better-profilers" title="永久链接至标题">¶</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> class of both modules, <code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> and <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>,
were written so that derived classes could be developed to extend the profiler.
The details are not described here, as doing this successfully requires an
expert understanding of how the <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> class works internally.  Study
the source code of the module carefully if you want to pursue this.</p>
<p>If all you want to do is change how current time is determined (for example, to
force use of wall-clock time or elapsed process time), pass the timing function
you want to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> class constructor:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">your_time_func</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting profiler will then call <code class="xref py py-func docutils literal notranslate"><span class="pre">your_time_func()</span></code>.</p>
<dl class="docutils">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">profile.Profile</span></code></dt>
<dd><p class="first"><code class="xref py py-func docutils literal notranslate"><span class="pre">your_time_func()</span></code> should return a single number, or a list of numbers whose
sum is the current time (like what <a class="reference internal" href="os.html#os.times" title="os.times"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.times()</span></code></a> returns).  If the function
returns a single time number, or the list of returned numbers has length 2, then
you will get an especially fast version of the dispatch routine.</p>
<p class="last">Be warned that you should calibrate the profiler class for the timer function
that you choose.  For most machines, a timer that returns a lone integer value
will provide the best results in terms of low overhead during profiling.
(<a class="reference internal" href="os.html#os.times" title="os.times"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.times()</span></code></a> is <em>pretty</em> bad, as it returns a tuple of floating point
values).  If you want to substitute a better timer in the cleanest fashion,
derive a class and hardwire a replacement dispatch method that best handles your
timer call, along with the appropriate calibration constant.</p>
</dd>
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code></dt>
<dd><p class="first"><code class="xref py py-func docutils literal notranslate"><span class="pre">your_time_func()</span></code> should return a single number.  If it returns
integers, you can also invoke the class constructor with a second argument
specifying the real duration of one unit of time.  For example, if
<code class="xref py py-func docutils literal notranslate"><span class="pre">your_integer_time_func()</span></code> returns times measured in thousands of seconds,
you would constuct the <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> instance as follows:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">your_integer_time_func</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">As the <code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile.Profile</span></code> class cannot be calibrated, custom timer
functions should be used with care and should be as fast as possible.  For the
best results with a custom timer, it might be necessary to hard-code it in the C
source of the internal <code class="xref py py-mod docutils literal notranslate"><span class="pre">_lsprof</span></code> module.</p>
</dd>
</dl>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Updated and converted to LaTeX by Guido van Rossum. Further updated by Armin
Rigo to integrate the documentation for the new <a class="reference internal" href="#module-cProfile" title="cProfile: Python profiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> module of Python
2.5.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Python Profilers</a><ul>
<li><a class="reference internal" href="#introduction-to-the-profilers">Introduction to the profilers</a></li>
<li><a class="reference internal" href="#instant-user-s-manual">Instant User’s Manual</a></li>
<li><a class="reference internal" href="#what-is-deterministic-profiling">What Is Deterministic Profiling?</a></li>
<li><a class="reference internal" href="#module-cProfile">Reference Manual – <code class="docutils literal notranslate"><span class="pre">profile</span></code> and <code class="docutils literal notranslate"><span class="pre">cProfile</span></code></a><ul>
<li><a class="reference internal" href="#the-stats-class">The <code class="docutils literal notranslate"><span class="pre">Stats</span></code> Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
<li><a class="reference internal" href="#calibration">Calibration</a></li>
<li><a class="reference internal" href="#extensions-deriving-better-profilers">Extensions — Deriving Better Profilers</a></li>
</ul>
</li>
</ul>

  <h4>上一个主题</h4>
  <p class="topless"><a href="pdb.html"
                        title="上一章"><code class="docutils literal notranslate"><span class="pre">pdb</span></code> — The Python Debugger</a></p>
  <h4>下一个主题</h4>
  <p class="topless"><a href="timeit.html"
                        title="下一章"><code class="docutils literal notranslate"><span class="pre">timeit</span></code> — Measure execution time of small code snippets</a></p>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/profile.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="转向" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="timeit.html" title="timeit — Measure execution time of small code snippets"
             >下一页</a> |</li>
        <li class="right" >
          <a href="pdb.html" title="pdb — The Python Debugger"
             >上一页</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

          <li id="cpython-language-and-version">
            <a href="../index.html">Python 3.0.1 文档</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Python Standard Library</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="debug.html" >Debugging and Profiling</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" type="text" name="q" />
          <input type="submit" value="转向" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">版权所有</a> 1990-2026, Python Software Foundation.
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    最后更新于 2月 04, 2026.
    
    <br />

    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.4.
    </div>

  </body>
</html>