
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>4. Building C and C++ Extensions on Windows &#8212; Python 3.1.5 documentation</title>
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="canonical" href="https://projects.localizethedocs.org/python-docs-l10n/extending/windows.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Python 3.1.5 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="5. Embedding Python in Another Application" href="embedding.html" />
    <link rel="prev" title="3. Building C and C++ Extensions with distutils" href="building.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/extending/windows.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>

    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
     

            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">
            <script type="text/javascript" src="../ltd-provenance.js"></script>
            <script type="text/javascript" src="../ltd-current.js"></script>
            <script type="text/javascript" src="../../../ltd-config.js"></script>
            <script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head><body>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="embedding.html" title="5. Embedding Python in Another Application"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="building.html" title="3. Building C and C++ Extensions with distutils"
             accesskey="P">previous</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

          <li id="cpython-language-and-version">
            <a href="../index.html">Python 3.1.5 documentation</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Extending and Embedding the Python Interpreter</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="building-c-and-c-extensions-on-windows">
<span id="building-on-windows"></span><h1>4. Building C and C++ Extensions on Windows<a class="headerlink" href="#building-c-and-c-extensions-on-windows" title="Permalink to this headline">¶</a></h1>
<p>This chapter briefly explains how to create a Windows extension module for
Python using Microsoft Visual C++, and follows with more detailed background
information on how it works.  The explanatory material is useful for both the
Windows programmer learning to build Python extensions and the Unix programmer
interested in producing software which can be successfully built on both Unix
and Windows.</p>
<p>Module authors are encouraged to use the distutils approach for building
extension modules, instead of the one described in this section. You will still
need the C compiler that was used to build Python; typically Microsoft Visual
C++.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This chapter mentions a number of filenames that include an encoded Python
version number.  These filenames are represented with the version number shown
as <code class="docutils literal notranslate"><span class="pre">XY</span></code>; in practice, <code class="docutils literal notranslate"><span class="pre">'X'</span></code> will be the major version number and <code class="docutils literal notranslate"><span class="pre">'Y'</span></code>
will be the minor version number of the Python release you’re working with.  For
example, if you are using Python 2.2.1, <code class="docutils literal notranslate"><span class="pre">XY</span></code> will actually be <code class="docutils literal notranslate"><span class="pre">22</span></code>.</p>
</div>
<div class="section" id="a-cookbook-approach">
<span id="win-cookbook"></span><h2>4.1. A Cookbook Approach<a class="headerlink" href="#a-cookbook-approach" title="Permalink to this headline">¶</a></h2>
<p>There are two approaches to building extension modules on Windows, just as there
are on Unix: use the <a class="reference internal" href="../library/distutils.html#module-distutils" title="distutils: Support for building and installing Python modules into an existing Python installation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">distutils</span></code></a> package to control the build process, or
do things manually.  The distutils approach works well for most extensions;
documentation on using <a class="reference internal" href="../library/distutils.html#module-distutils" title="distutils: Support for building and installing Python modules into an existing Python installation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">distutils</span></code></a> to build and package extension modules
is available in <a class="reference internal" href="../distutils/index.html#distutils-index"><span class="std std-ref">Distributing Python Modules</span></a>.  This section describes the manual
approach to building Python extensions written in C or C++.</p>
<p>To build extensions using these instructions, you need to have a copy of the
Python sources of the same version as your installed Python. You will need
Microsoft Visual C++ “Developer Studio”; project files are supplied for VC++
version 7.1, but you can use older versions of VC++.  Notice that you should use
the same version of VC++that was used to build Python itself. The example files
described here are distributed with the Python sources in the
<code class="file docutils literal notranslate"><span class="pre">PC\example_nt\</span></code> directory.</p>
<ol class="arabic">
<li><p class="first"><strong>Copy the example files</strong> —  The <code class="file docutils literal notranslate"><span class="pre">example_nt</span></code> directory is a
subdirectory of the <code class="file docutils literal notranslate"><span class="pre">PC</span></code> directory, in order to keep all the PC-specific
files under the same directory in the source distribution.  However, the
<code class="file docutils literal notranslate"><span class="pre">example_nt</span></code> directory can’t actually be used from this location.  You
first need to copy or move it up one level, so that <code class="file docutils literal notranslate"><span class="pre">example_nt</span></code> is a
sibling of the <code class="file docutils literal notranslate"><span class="pre">PC</span></code> and <code class="file docutils literal notranslate"><span class="pre">Include</span></code> directories.  Do all your work
from within this new location.</p>
</li>
<li><p class="first"><strong>Open the project</strong> —  From VC++, use the <span class="menuselection">File ‣ Open
Solution</span> dialog (not <span class="menuselection">File ‣ Open</span>!).  Navigate to and select
the file <code class="file docutils literal notranslate"><span class="pre">example.sln</span></code>, in the <em>copy</em> of the <code class="file docutils literal notranslate"><span class="pre">example_nt</span></code> directory
you made above.  Click Open.</p>
</li>
<li><p class="first"><strong>Build the example DLL</strong> —  In order to check that everything is set up
right, try building:</p>
</li>
<li><p class="first">Select a configuration.  This step is optional.  Choose
<span class="menuselection">Build ‣ Configuration Manager ‣ Active Solution Configuration</span>
and select either <span class="guilabel">Release</span>  or <span class="guilabel">Debug</span>.  If you skip this
step, VC++ will use the Debug configuration by default.</p>
</li>
<li><p class="first">Build the DLL.  Choose <span class="menuselection">Build ‣ Build Solution</span>.  This
creates all intermediate and result files in a subdirectory called either
<code class="file docutils literal notranslate"><span class="pre">Debug</span></code> or <code class="file docutils literal notranslate"><span class="pre">Release</span></code>, depending on which configuration you selected
in the preceding step.</p>
</li>
<li><p class="first"><strong>Testing the debug-mode DLL</strong> —  Once the Debug build has succeeded, bring
up a DOS box, and change to the <code class="file docutils literal notranslate"><span class="pre">example_nt\Debug</span></code> directory.  You should
now be able to repeat the following session (<code class="docutils literal notranslate"><span class="pre">C&gt;</span></code> is the DOS prompt, <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code>
is the Python prompt; note that build information and various debug output from
Python may not match this screen dump exactly):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>C&gt;..\..\PCbuild\python_d
Adding parser accelerators ...
Done.
Python 2.2 (#28, Dec 19 2001, 23:26:37) [MSC 32 bit (Intel)] on win32
Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import example
[4897 refs]
&gt;&gt;&gt; example.foo()
Hello, world
[4903 refs]
&gt;&gt;&gt;
</pre></div>
</div>
<p>Congratulations!  You’ve successfully built your first Python extension module.</p>
</li>
<li><p class="first"><strong>Creating your own project</strong> —  Choose a name and create a directory for
it.  Copy your C sources into it.  Note that the module source file name does
not necessarily have to match the module name, but the name of the
initialization function should match the module name — you can only import a
module <code class="xref py py-mod docutils literal notranslate"><span class="pre">spam</span></code> if its initialization function is called <a href="#id1"><span class="problematic" id="id2">:cfunc:`initspam`</span></a>,
and it should call <a href="#id3"><span class="problematic" id="id4">:cfunc:`Py_InitModule`</span></a> with the string <code class="docutils literal notranslate"><span class="pre">&quot;spam&quot;</span></code> as its
first argument (use the minimal <code class="file docutils literal notranslate"><span class="pre">example.c</span></code> in this directory as a guide).
By convention, it lives in a file called <code class="file docutils literal notranslate"><span class="pre">spam.c</span></code> or <code class="file docutils literal notranslate"><span class="pre">spammodule.c</span></code>.
The output file should be called <code class="file docutils literal notranslate"><span class="pre">spam.pyd</span></code> (in Release mode) or
<code class="file docutils literal notranslate"><span class="pre">spam_d.pyd</span></code> (in Debug mode). The extension <code class="file docutils literal notranslate"><span class="pre">.pyd</span></code> was chosen
to avoid confusion with a system library <code class="file docutils literal notranslate"><span class="pre">spam.dll</span></code> to which your module
could be a Python interface.</p>
<p>Now your options are:</p>
</li>
<li><p class="first">Copy <code class="file docutils literal notranslate"><span class="pre">example.sln</span></code> and <code class="file docutils literal notranslate"><span class="pre">example.vcproj</span></code>, rename them to
<code class="file docutils literal notranslate"><span class="pre">spam.*</span></code>, and edit them by hand, or</p>
</li>
<li><p class="first">Create a brand new project; instructions are below.</p>
<p>In either case, copy <code class="file docutils literal notranslate"><span class="pre">example_nt\example.def</span></code> to <code class="file docutils literal notranslate"><span class="pre">spam\spam.def</span></code>,
and edit the new <code class="file docutils literal notranslate"><span class="pre">spam.def</span></code> so its second line contains the string
‘<code class="docutils literal notranslate"><span class="pre">initspam</span></code>’.  If you created a new project yourself, add the file
<code class="file docutils literal notranslate"><span class="pre">spam.def</span></code> to the project now.  (This is an annoying little file with only
two lines.  An alternative approach is to forget about the <code class="file docutils literal notranslate"><span class="pre">.def</span></code> file,
and add the option <code class="xref std std-option docutils literal notranslate"><span class="pre">/export:initspam</span></code> somewhere to the Link settings, by
manually editing the setting in Project Properties dialog).</p>
</li>
<li><p class="first"><strong>Creating a brand new project</strong> —  Use the <span class="menuselection">File ‣ New
‣ Project</span> dialog to create a new Project Workspace.  Select <span class="guilabel">Visual
C++ Projects/Win32/ Win32 Project</span>, enter the name (<code class="docutils literal notranslate"><span class="pre">spam</span></code>), and make sure the
Location is set to parent of the <code class="file docutils literal notranslate"><span class="pre">spam</span></code> directory you have created (which
should be a direct subdirectory of the Python build tree, a sibling of
<code class="file docutils literal notranslate"><span class="pre">Include</span></code> and <code class="file docutils literal notranslate"><span class="pre">PC</span></code>).  Select Win32 as the platform (in my version,
this is the only choice).  Make sure the Create new workspace radio button is
selected.  Click OK.</p>
<p>You should now create the file <code class="file docutils literal notranslate"><span class="pre">spam.def</span></code> as instructed in the previous
section. Add the source files to the project, using <span class="menuselection">Project ‣
Add Existing Item</span>. Set the pattern to <code class="docutils literal notranslate"><span class="pre">*.*</span></code> and select both <code class="file docutils literal notranslate"><span class="pre">spam.c</span></code>
and <code class="file docutils literal notranslate"><span class="pre">spam.def</span></code> and click OK.  (Inserting them one by one is fine too.)</p>
<p>Now open the <span class="menuselection">Project ‣ spam properties</span> dialog. You only need
to change a few settings.  Make sure <span class="guilabel">All Configurations</span> is selected
from the <span class="guilabel">Settings for:</span> dropdown list.  Select the C/C++ tab.  Choose
the General category in the popup menu at the top.  Type the following text in
the entry box labeled <span class="guilabel">Additional Include Directories</span>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>..\Include,..\PC
</pre></div>
</div>
<p>Then, choose the General category in the Linker tab, and enter</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>..\PCbuild
</pre></div>
</div>
<p>in the text box labelled <span class="guilabel">Additional library Directories</span>.</p>
<p>Now you need to add some mode-specific settings:</p>
<p>Select <span class="guilabel">Release</span> in the <span class="guilabel">Configuration</span> dropdown list.
Choose the <span class="guilabel">Link</span> tab, choose the <span class="guilabel">Input</span> category, and
append <code class="docutils literal notranslate"><span class="pre">pythonXY.lib</span></code> to the list in the <span class="guilabel">Additional Dependencies</span>
box.</p>
<p>Select <span class="guilabel">Debug</span> in the <span class="guilabel">Configuration</span> dropdown list, and
append <code class="docutils literal notranslate"><span class="pre">pythonXY_d.lib</span></code> to the list in the <span class="guilabel">Additional Dependencies</span>
box.  Then click the C/C++ tab, select <span class="guilabel">Code Generation</span>, and select
<span class="guilabel">Multi-threaded Debug DLL</span> from the <span class="guilabel">Runtime library</span>
dropdown list.</p>
<p>Select <span class="guilabel">Release</span> again from the <span class="guilabel">Configuration</span> dropdown
list.  Select <span class="guilabel">Multi-threaded DLL</span> from the <span class="guilabel">Runtime
library</span> dropdown list.</p>
</li>
</ol>
<p>If your module creates a new type, you may have trouble with this line:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">PyVarObject_HEAD_INIT</span><span class="p">(</span><span class="o">&amp;</span><span class="n">PyType_Type</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Static type object initializers in extension modules may cause
compiles to fail with an error message like “initializer not a
constant”.  This shows up when building DLL under MSVC.  Change it to:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">PyVarObject_HEAD_INIT</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>and add the following to the module initialization function:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyType_Ready</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyObject_Type</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="differences-between-unix-and-windows">
<span id="dynamic-linking"></span><h2>4.2. Differences Between Unix and Windows<a class="headerlink" href="#differences-between-unix-and-windows" title="Permalink to this headline">¶</a></h2>
<p>Unix and Windows use completely different paradigms for run-time loading of
code.  Before you try to build a module that can be dynamically loaded, be aware
of how your system works.</p>
<p>In Unix, a shared object (<code class="file docutils literal notranslate"><span class="pre">.so</span></code>) file contains code to be used by the
program, and also the names of functions and data that it expects to find in the
program.  When the file is joined to the program, all references to those
functions and data in the file’s code are changed to point to the actual
locations in the program where the functions and data are placed in memory.
This is basically a link operation.</p>
<p>In Windows, a dynamic-link library (<code class="file docutils literal notranslate"><span class="pre">.dll</span></code>) file has no dangling
references.  Instead, an access to functions or data goes through a lookup
table.  So the DLL code does not have to be fixed up at runtime to refer to the
program’s memory; instead, the code already uses the DLL’s lookup table, and the
lookup table is modified at runtime to point to the functions and data.</p>
<p>In Unix, there is only one type of library file (<code class="file docutils literal notranslate"><span class="pre">.a</span></code>) which contains code
from several object files (<code class="file docutils literal notranslate"><span class="pre">.o</span></code>).  During the link step to create a shared
object file (<code class="file docutils literal notranslate"><span class="pre">.so</span></code>), the linker may find that it doesn’t know where an
identifier is defined.  The linker will look for it in the object files in the
libraries; if it finds it, it will include all the code from that object file.</p>
<p>In Windows, there are two types of library, a static library and an import
library (both called <code class="file docutils literal notranslate"><span class="pre">.lib</span></code>).  A static library is like a Unix <code class="file docutils literal notranslate"><span class="pre">.a</span></code>
file; it contains code to be included as necessary. An import library is
basically used only to reassure the linker that a certain identifier is legal,
and will be present in the program when the DLL is loaded.  So the linker uses
the information from the import library to build the lookup table for using
identifiers that are not included in the DLL.  When an application or a DLL is
linked, an import library may be generated, which will need to be used for all
future DLLs that depend on the symbols in the application or DLL.</p>
<p>Suppose you are building two dynamic-load modules, B and C, which should share
another block of code A.  On Unix, you would <em>not</em> pass <code class="file docutils literal notranslate"><span class="pre">A.a</span></code> to the
linker for <code class="file docutils literal notranslate"><span class="pre">B.so</span></code> and <code class="file docutils literal notranslate"><span class="pre">C.so</span></code>; that would cause it to be included
twice, so that B and C would each have their own copy.  In Windows, building
<code class="file docutils literal notranslate"><span class="pre">A.dll</span></code> will also build <code class="file docutils literal notranslate"><span class="pre">A.lib</span></code>.  You <em>do</em> pass <code class="file docutils literal notranslate"><span class="pre">A.lib</span></code> to the
linker for B and C.  <code class="file docutils literal notranslate"><span class="pre">A.lib</span></code> does not contain code; it just contains
information which will be used at runtime to access A’s code.</p>
<p>In Windows, using an import library is sort of like using <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">spam</span></code>; it
gives you access to spam’s names, but does not create a separate copy.  On Unix,
linking with a library is more like <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">spam</span> <span class="pre">import</span> <span class="pre">*</span></code>; it does create a
separate copy.</p>
</div>
<div class="section" id="using-dlls-in-practice">
<span id="win-dlls"></span><h2>4.3. Using DLLs in Practice<a class="headerlink" href="#using-dlls-in-practice" title="Permalink to this headline">¶</a></h2>
<p>Windows Python is built in Microsoft Visual C++; using other compilers may or
may not work (though Borland seems to).  The rest of this section is MSVC++
specific.</p>
<p>When creating DLLs in Windows, you must pass <code class="file docutils literal notranslate"><span class="pre">pythonXY.lib</span></code> to the linker.
To build two DLLs, spam and ni (which uses C functions found in spam), you could
use these commands:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cl</span><span class="w"> </span><span class="o">/</span><span class="n">LD</span><span class="w"> </span><span class="o">/</span><span class="n">I</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">include</span><span class="w"> </span><span class="n">spam</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">pythonXY</span><span class="p">.</span><span class="n">lib</span>
<span class="n">cl</span><span class="w"> </span><span class="o">/</span><span class="n">LD</span><span class="w"> </span><span class="o">/</span><span class="n">I</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">include</span><span class="w"> </span><span class="n">ni</span><span class="p">.</span><span class="n">c</span><span class="w"> </span><span class="n">spam</span><span class="p">.</span><span class="n">lib</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="n">libs</span><span class="o">/</span><span class="n">pythonXY</span><span class="p">.</span><span class="n">lib</span>
</pre></div>
</div>
<p>The first command created three files: <code class="file docutils literal notranslate"><span class="pre">spam.obj</span></code>, <code class="file docutils literal notranslate"><span class="pre">spam.dll</span></code> and
<code class="file docutils literal notranslate"><span class="pre">spam.lib</span></code>.  <code class="file docutils literal notranslate"><span class="pre">Spam.dll</span></code> does not contain any Python functions (such
as <a href="#id5"><span class="problematic" id="id6">:cfunc:`PyArg_ParseTuple`</span></a>), but it does know how to find the Python code
thanks to <code class="file docutils literal notranslate"><span class="pre">pythonXY.lib</span></code>.</p>
<p>The second command created <code class="file docutils literal notranslate"><span class="pre">ni.dll</span></code> (and <code class="file docutils literal notranslate"><span class="pre">.obj</span></code> and <code class="file docutils literal notranslate"><span class="pre">.lib</span></code>),
which knows how to find the necessary functions from spam, and also from the
Python executable.</p>
<p>Not every identifier is exported to the lookup table.  If you want any other
modules (including Python) to be able to see your identifiers, you have to say
<code class="docutils literal notranslate"><span class="pre">_declspec(dllexport)</span></code>, as in <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">_declspec(dllexport)</span> <span class="pre">initspam(void)</span></code> or
<code class="docutils literal notranslate"><span class="pre">PyObject</span> <span class="pre">_declspec(dllexport)</span> <span class="pre">*NiGetSpamData(void)</span></code>.</p>
<p>Developer Studio will throw in a lot of import libraries that you do not really
need, adding about 100K to your executable.  To get rid of them, use the Project
Settings dialog, Link tab, to specify <em>ignore default libraries</em>.  Add the
correct <code class="file docutils literal notranslate"><span class="pre">msvcrtxx.lib</span></code> to the list of libraries.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4. Building C and C++ Extensions on Windows</a><ul>
<li><a class="reference internal" href="#a-cookbook-approach">4.1. A Cookbook Approach</a></li>
<li><a class="reference internal" href="#differences-between-unix-and-windows">4.2. Differences Between Unix and Windows</a></li>
<li><a class="reference internal" href="#using-dlls-in-practice">4.3. Using DLLs in Practice</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="building.html"
                        title="previous chapter">3. Building C and C++ Extensions with distutils</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="embedding.html"
                        title="next chapter">5. Embedding Python in Another Application</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/extending/windows.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="embedding.html" title="5. Embedding Python in Another Application"
             >next</a> |</li>
        <li class="right" >
          <a href="building.html" title="3. Building C and C++ Extensions with distutils"
             >previous</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

          <li id="cpython-language-and-version">
            <a href="../index.html">Python 3.1.5 documentation</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Extending and Embedding the Python Interpreter</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 1990-2025, Python Software Foundation.
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Last updated on Oct 29, 2025.
    
    <br />

    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.4.
    </div>

  </body>
</html>