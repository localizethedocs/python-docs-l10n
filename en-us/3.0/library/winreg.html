
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>winreg – Windows registry access &#8212; Python 3.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="canonical" href="https://projects.localizethedocs.org/python-docs-l10n/library/winreg.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Python 3.0.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="winsound — Sound-playing interface for Windows" href="winsound.html" />
    <link rel="prev" title="msvcrt – Useful routines from the MS VC++ runtime" href="msvcrt.html" />
    
    <link rel="canonical" href="https://docs.python.org/3/library/winreg.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>

    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
     

            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">
            <script type="text/javascript" src="../ltd-provenance.js"></script>
            <script type="text/javascript" src="../ltd-current.js"></script>
            <script type="text/javascript" src="../../../ltd-config.js"></script>
            <script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head><body>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="winsound.html" title="winsound — Sound-playing interface for Windows"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="msvcrt.html" title="msvcrt – Useful routines from the MS VC++ runtime"
             accesskey="P">previous</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

          <li id="cpython-language-and-version">
            <a href="../index.html">Python 3.0.1 documentation</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Python Standard Library</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="windows.html" accesskey="U">MS Windows Specific Services</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-winreg">
<span id="winreg-windows-registry-access"></span><h1><a class="reference internal" href="#module-winreg" title="winreg: Routines and objects for manipulating the Windows registry. (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">winreg</span></code></a> – Windows registry access<a class="headerlink" href="#module-winreg" title="Permalink to this headline">¶</a></h1>
<p>These functions expose the Windows registry API to Python.  Instead of using an
integer as the registry handle, a handle object is used to ensure that the
handles are closed correctly, even if the programmer neglects to explicitly
close them.</p>
<p>This module exposes a very low-level interface to the Windows registry; it is
expected that in the future a new <code class="docutils literal notranslate"><span class="pre">winreg</span></code>  module will be created offering a
higher-level interface to the registry API.</p>
<p>This module offers the following functions:</p>
<dl class="function">
<dt id="winreg.CloseKey">
<code class="descclassname">winreg.</code><code class="descname">CloseKey</code><span class="sig-paren">(</span><em>hkey</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CloseKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes a previously opened registry key. The hkey argument specifies a
previously opened key.</p>
<p>Note that if <em>hkey</em> is not closed using this method (or via
<code class="xref py py-meth docutils literal notranslate"><span class="pre">handle.Close()</span></code>), it is closed when the <em>hkey</em> object is destroyed by
Python.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.ConnectRegistry">
<code class="descclassname">winreg.</code><code class="descname">ConnectRegistry</code><span class="sig-paren">(</span><em>computer_name</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.ConnectRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Establishes a connection to a predefined registry handle on  another computer,
and returns a <em class="dfn">handle object</em></p>
<p><em>computer_name</em> is the name of the remote computer, of the  form
<code class="docutils literal notranslate"><span class="pre">r&quot;\\computername&quot;</span></code>.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the local computer is used.</p>
<p><em>key</em> is the predefined handle to connect to.</p>
<p>The return value is the handle of the opened key. If the function fails, an
<a class="reference internal" href="exceptions.html#exceptions.EnvironmentError" title="exceptions.EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a> exception is  raised.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.CreateKey">
<code class="descclassname">winreg.</code><code class="descname">CreateKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CreateKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates or opens the specified key, returning a <em class="dfn">handle object</em></p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>sub_key</em> is a string that names the key this method opens  or creates.</p>
<p>If <em>key</em> is one of the predefined keys, <em>sub_key</em> may  be <code class="docutils literal notranslate"><span class="pre">None</span></code>. In that
case, the handle returned is the same key handle  passed in to the function.</p>
<p>If the key already exists, this function opens the existing key.</p>
<p>The return value is the handle of the opened key. If the function fails, an
<a class="reference internal" href="exceptions.html#exceptions.EnvironmentError" title="exceptions.EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a> exception is  raised.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteKey">
<code class="descclassname">winreg.</code><code class="descname">DeleteKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the specified key.</p>
<p><em>key</em> is an already open key, or any one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>sub_key</em> is a string that must be a subkey of the key  identified by the <em>key</em>
parameter.  This value must not be  <code class="docutils literal notranslate"><span class="pre">None</span></code>, and the key may not have subkeys.</p>
<p><em>This method can not delete keys with subkeys.</em></p>
<p>If the method succeeds, the entire key, including all of its values, is removed.
If the method fails, an <a class="reference internal" href="exceptions.html#exceptions.EnvironmentError" title="exceptions.EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a>  exception is raised.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteValue">
<code class="descclassname">winreg.</code><code class="descname">DeleteValue</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a named value from a registry key.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>value</em> is a string that identifies the value to remove.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.EnumKey">
<code class="descclassname">winreg.</code><code class="descname">EnumKey</code><span class="sig-paren">(</span><em>key</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnumKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerates subkeys of an open registry key, returning a string.</p>
<p><em>key</em> is an already open key, or any one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>index</em> is an integer that identifies the index of the key to  retrieve.</p>
<p>The function retrieves the name of one subkey each time it  is called.  It is
typically called repeatedly until an  <a class="reference internal" href="exceptions.html#exceptions.EnvironmentError" title="exceptions.EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a> exception  is
raised, indicating, no more values are available.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.EnumValue">
<code class="descclassname">winreg.</code><code class="descname">EnumValue</code><span class="sig-paren">(</span><em>key</em>, <em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnumValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumerates values of an open registry key, returning a tuple.</p>
<p><em>key</em> is an already open key, or any one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>index</em> is an integer that identifies the index of the value  to retrieve.</p>
<p>The function retrieves the name of one subkey each time it is  called. It is
typically called repeatedly, until an  <a class="reference internal" href="exceptions.html#exceptions.EnvironmentError" title="exceptions.EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a> exception is
raised, indicating  no more values.</p>
<p>The result is a tuple of 3 items:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>A string that identifies the value name</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">1</span></code></td>
<td>An object that holds the value data, and
whose type depends on the underlying
registry type</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">2</span></code></td>
<td>An integer that identifies the type of the
value data</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="winreg.ExpandEnvironmentStrings">
<code class="descclassname">winreg.</code><code class="descname">ExpandEnvironmentStrings</code><span class="sig-paren">(</span><em>unicode</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.ExpandEnvironmentStrings" title="Permalink to this definition">¶</a></dt>
<dd><p>Expands environment strings %NAME% in unicode string like const:<cite>REG_EXPAND_SZ</cite>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExpandEnvironmentStrings</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;%windir%&quot;</span><span class="p">)</span>
<span class="go">u&quot;C:\\Windows&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.FlushKey">
<code class="descclassname">winreg.</code><code class="descname">FlushKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.FlushKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes all the attributes of a key to the registry.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p>It is not necessary to call <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> to change a key. Registry changes are
flushed to disk by the registry using its lazy  flusher.  Registry changes are
also flushed to disk at system  shutdown.  Unlike <a class="reference internal" href="#winreg.CloseKey" title="winreg.CloseKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CloseKey()</span></code></a>, the
<a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> method  returns only when all the data has been written to the
registry. An application should only call <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> if it requires
absolute  certainty that registry changes are on disk.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you don’t know whether a <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> call is required, it  probably
isn’t.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.LoadKey">
<code class="descclassname">winreg.</code><code class="descname">LoadKey</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.LoadKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a subkey under the specified key and stores registration  information
from a specified file into that subkey.</p>
<p><em>key</em> is an already open key, or any of the predefined <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>sub_key</em> is a string that identifies the sub_key to load.</p>
<p><em>file_name</em> is the name of the file to load registry data from. This file must
have been created with the <a class="reference internal" href="#winreg.SaveKey" title="winreg.SaveKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">SaveKey()</span></code></a> function. Under the file allocation
table (FAT) file system, the filename may not have an extension.</p>
<p>A call to LoadKey() fails if the calling process does not have the
<code class="xref py py-const docutils literal notranslate"><span class="pre">SE_RESTORE_PRIVILEGE</span></code> privilege. Note that privileges are different than
permissions - see the Win32 documentation for more details.</p>
<p>If <em>key</em> is a handle returned by <a class="reference internal" href="#winreg.ConnectRegistry" title="winreg.ConnectRegistry"><code class="xref py py-func docutils literal notranslate"><span class="pre">ConnectRegistry()</span></code></a>,  then the path
specified in <em>fileName</em> is relative to the  remote computer.</p>
<p>The Win32 documentation implies <em>key</em> must be in the  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_USER</span></code> or
<code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE</span></code> tree. This may or may not be true.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.OpenKey">
<code class="descclassname">winreg.</code><code class="descname">OpenKey</code><span class="sig-paren">(</span><em>key, sub_key[, res=0][, sam=KEY_READ]</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.OpenKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens the specified key, returning a <em class="dfn">handle object</em></p>
<p><em>key</em> is an already open key, or any one of the predefined <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>sub_key</em> is a string that identifies the sub_key to open.</p>
<p><em>res</em> is a reserved integer, and must be zero.  The default is zero.</p>
<p><em>sam</em> is an integer that specifies an access mask that describes  the desired
security access for the key.  Default is <code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_READ</span></code></p>
<p>The result is a new handle to the specified key.</p>
<p>If the function fails, <a class="reference internal" href="exceptions.html#exceptions.EnvironmentError" title="exceptions.EnvironmentError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">EnvironmentError</span></code></a> is raised.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.OpenKeyEx">
<code class="descclassname">winreg.</code><code class="descname">OpenKeyEx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.OpenKeyEx" title="Permalink to this definition">¶</a></dt>
<dd><p>The functionality of <a class="reference internal" href="#winreg.OpenKeyEx" title="winreg.OpenKeyEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">OpenKeyEx()</span></code></a> is provided via <a class="reference internal" href="#winreg.OpenKey" title="winreg.OpenKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">OpenKey()</span></code></a>, by the
use of default arguments.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryInfoKey">
<code class="descclassname">winreg.</code><code class="descname">QueryInfoKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryInfoKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns information about a key, as a tuple.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p>The result is a tuple of 3 items:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>An integer giving the number of sub keys
this key has.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">1</span></code></td>
<td>An integer giving the number of values this
key has.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">2</span></code></td>
<td>An integer giving when the key was last
modified (if available) as 100’s of
nanoseconds since Jan 1, 1600.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryValue">
<code class="descclassname">winreg.</code><code class="descname">QueryValue</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the unnamed value for a key, as a string</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>sub_key</em> is a string that holds the name of the subkey with which  the value is
associated.  If this parameter is <code class="docutils literal notranslate"><span class="pre">None</span></code> or empty, the  function retrieves the
value set by the <a class="reference internal" href="#winreg.SetValue" title="winreg.SetValue"><code class="xref py py-func docutils literal notranslate"><span class="pre">SetValue()</span></code></a> method  for the key identified by <em>key</em>.</p>
<p>Values in the registry have name, type, and data components. This  method
retrieves the data for a key’s first value that has a NULL name. But the
underlying API call doesn’t return the type, Lame Lame Lame, DO NOT USE THIS!!!</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryValueEx">
<code class="descclassname">winreg.</code><code class="descname">QueryValueEx</code><span class="sig-paren">(</span><em>key</em>, <em>value_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryValueEx" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the type and data for a specified value name associated with  an open
registry key.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>value_name</em> is a string indicating the value to query.</p>
<p>The result is a tuple of 2 items:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
<td>The value of the registry item.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">1</span></code></td>
<td>An integer giving the registry type for
this value.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="winreg.SaveKey">
<code class="descclassname">winreg.</code><code class="descname">SaveKey</code><span class="sig-paren">(</span><em>key</em>, <em>file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SaveKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the specified key, and all its subkeys to the specified file.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>file_name</em> is the name of the file to save registry data to. This file cannot
already exist. If this filename includes an extension, it cannot be used on file
allocation table (FAT) file systems by the <a class="reference internal" href="#winreg.LoadKey" title="winreg.LoadKey"><code class="xref py py-meth docutils literal notranslate"><span class="pre">LoadKey()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ReplaceKey()</span></code>
or  <code class="xref py py-meth docutils literal notranslate"><span class="pre">RestoreKey()</span></code> methods.</p>
<p>If <em>key</em> represents a key on a remote computer, the path  described by
<em>file_name</em> is relative to the remote computer. The caller of this method must
possess the <code class="xref py py-const docutils literal notranslate"><span class="pre">SeBackupPrivilege</span></code>  security privilege.  Note that
privileges are different than permissions  - see the Win32 documentation for
more details.</p>
<p>This function passes NULL for <em>security_attributes</em> to the API.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SetValue">
<code class="descclassname">winreg.</code><code class="descname">SetValue</code><span class="sig-paren">(</span><em>key</em>, <em>sub_key</em>, <em>type</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SetValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Associates a value with a specified key.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>sub_key</em> is a string that names the subkey with which the value  is associated.</p>
<p><em>type</em> is an integer that specifies the type of the data. Currently this must be
<code class="xref py py-const docutils literal notranslate"><span class="pre">REG_SZ</span></code>, meaning only strings are supported.  Use the <a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a>
function for support for other data types.</p>
<p><em>value</em> is a string that specifies the new value.</p>
<p>If the key specified by the <em>sub_key</em> parameter does not exist, the SetValue
function creates it.</p>
<p>Value lengths are limited by available memory. Long values (more than 2048
bytes) should be stored as files with the filenames stored in the configuration
registry.  This helps the registry perform efficiently.</p>
<p>The key identified by the <em>key</em> parameter must have been  opened with
<code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code> access.</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SetValueEx">
<code class="descclassname">winreg.</code><code class="descname">SetValueEx</code><span class="sig-paren">(</span><em>key</em>, <em>value_name</em>, <em>reserved</em>, <em>type</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SetValueEx" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores data in the value field of an open registry key.</p>
<p><em>key</em> is an already open key, or one of the predefined  <code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_*</span></code>
constants.</p>
<p><em>value_name</em> is a string that names the subkey with which the  value is
associated.</p>
<p><em>type</em> is an integer that specifies the type of the data.   This should be one
of the following constants defined in this module:</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Constant</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_BINARY</span></code></td>
<td>Binary data in any form.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_DWORD</span></code></td>
<td>A 32-bit number.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_DWORD_LITTLE_ENDIAN</span></code></td>
<td>A 32-bit number in little-endian format.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_DWORD_BIG_ENDIAN</span></code></td>
<td>A 32-bit number in big-endian format.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_EXPAND_SZ</span></code></td>
<td>Null-terminated string containing
references to environment variables
(<code class="docutils literal notranslate"><span class="pre">%PATH%</span></code>).</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_LINK</span></code></td>
<td>A Unicode symbolic link.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_MULTI_SZ</span></code></td>
<td>A sequence of null-terminated strings,
terminated by two null characters.  (Python
handles  this termination automatically.)</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_NONE</span></code></td>
<td>No defined value type.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_RESOURCE_LIST</span></code></td>
<td>A device-driver resource list.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_SZ</span></code></td>
<td>A null-terminated string.</td>
</tr>
</tbody>
</table>
<p><em>reserved</em> can be anything - zero is always passed to the  API.</p>
<p><em>value</em> is a string that specifies the new value.</p>
<p>This method can also set additional value and type information for the specified
key.  The key identified by the key parameter must have been opened with
<code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code> access.</p>
<p>To open the key, use the <code class="xref py py-func docutils literal notranslate"><span class="pre">CreateKeyEx()</span></code> or  <a class="reference internal" href="#winreg.OpenKey" title="winreg.OpenKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">OpenKey()</span></code></a> methods.</p>
<p>Value lengths are limited by available memory. Long values (more than 2048
bytes) should be stored as files with the filenames stored in the configuration
registry.  This helps the registry perform efficiently.</p>
</dd></dl>

<div class="section" id="registry-handle-objects">
<span id="handle-object"></span><h2>Registry Handle Objects<a class="headerlink" href="#registry-handle-objects" title="Permalink to this headline">¶</a></h2>
<p>This object wraps a Windows HKEY object, automatically closing it when the
object is destroyed.  To guarantee cleanup, you can call either the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Close()</span></code> method on the object, or the  <a class="reference internal" href="#winreg.CloseKey" title="winreg.CloseKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CloseKey()</span></code></a> function.</p>
<p>All registry functions in this module return one of these objects.</p>
<p>All registry functions in this module which accept a handle object  also accept
an integer, however, use of the handle object is  encouraged.</p>
<p>Handle objects provide semantics for <a class="reference internal" href="../reference/datamodel.html#object.__bool__" title="object.__bool__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__bool__()</span></code></a> - thus</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">handle</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will print <code class="docutils literal notranslate"><span class="pre">Yes</span></code> if the handle is currently valid (has not been closed or
detached).</p>
<p>The object also support comparison semantics, so handle objects will compare
true if they both reference the same underlying Windows handle value.</p>
<p>Handle objects can be converted to an integer (e.g., using the builtin
<a class="reference internal" href="functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> function), in which case the underlying Windows handle value is
returned.  You can also use the  <code class="xref py py-meth docutils literal notranslate"><span class="pre">Detach()</span></code> method to return the integer
handle, and also disconnect the Windows handle from the handle object.</p>
<dl class="method">
<dt id="winreg.PyHKEY.Close">
<code class="descclassname">PyHKEY.</code><code class="descname">Close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.Close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the underlying Windows handle.</p>
<p>If the handle is already closed, no error is raised.</p>
</dd></dl>

<dl class="method">
<dt id="winreg.PyHKEY.Detach">
<code class="descclassname">PyHKEY.</code><code class="descname">Detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.Detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Detaches the Windows handle from the handle object.</p>
<p>The result is an integer that holds the value of the handle before it is
detached.  If the handle is already detached or closed, this will return
zero.</p>
<p>After calling this function, the handle is effectively invalidated, but the
handle is not closed.  You would call this function when  you need the
underlying Win32 handle to exist beyond the lifetime  of the handle object.</p>
</dd></dl>

<dl class="method">
<dt id="winreg.PyHKEY.__enter__">
<code class="descclassname">PyHKEY.</code><code class="descname">__enter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.__enter__" title="Permalink to this definition">¶</a></dt>
<dt id="winreg.PyHKEY.__exit__">
<code class="descclassname">PyHKEY.</code><code class="descname">__exit__</code><span class="sig-paren">(</span><em>*exc_info</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.__exit__" title="Permalink to this definition">¶</a></dt>
<dd><p>The HKEY object implements <a class="reference internal" href="#winreg.PyHKEY.__enter__" title="winreg.PyHKEY.__enter__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__enter__()</span></code></a> and <a class="reference internal" href="#winreg.PyHKEY.__exit__" title="winreg.PyHKEY.__exit__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__exit__()</span></code></a> and thus
supports the context protocol for the <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> statement:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">OpenKey</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">key</span><span class="p">:</span>
    <span class="c1"># ... work with key ...</span>
</pre></div>
</div>
<p>will automatically close <em>key</em> when control leaves the <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> block.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">winreg</span></code> – Windows registry access</a><ul>
<li><a class="reference internal" href="#registry-handle-objects">Registry Handle Objects</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="msvcrt.html"
                        title="previous chapter"><code class="docutils literal notranslate"><span class="pre">msvcrt</span></code> – Useful routines from the MS VC++ runtime</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="winsound.html"
                        title="next chapter"><code class="docutils literal notranslate"><span class="pre">winsound</span></code> — Sound-playing interface for Windows</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/library/winreg.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="winsound.html" title="winsound — Sound-playing interface for Windows"
             >next</a> |</li>
        <li class="right" >
          <a href="msvcrt.html" title="msvcrt – Useful routines from the MS VC++ runtime"
             >previous</a> |</li>

    <li><img src="../_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="https://www.python.org/">Python</a> &#187;</li>
    

          <li id="cpython-language-and-version">
            <a href="../index.html">Python 3.0.1 documentation</a> &#187;
          </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Python Standard Library</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="windows.html" >MS Windows Specific Services</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 1990-2026, Python Software Foundation.
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Last updated on Feb 04, 2026.
    
    <br />

    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.4.
    </div>

  </body>
</html>